-- Creating Database and Schema
CREATE OR REPLACE DATABASE RETAIL_SALES;
CREATE OR REPLACE SCHEMA RETAIL_SALES.RETAIL_SALES_SCHEMA;

-- Creating File Format for CSV
CREATE OR REPLACE FILE FORMAT RETAIL_SALES.RETAIL_SALES_SCHEMA.CSV_FILE
    TYPE = CSV
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1;

-- Creating Stage
CREATE OR REPLACE STAGE RETAIL_SALES.RETAIL_SALES_SCHEMA.AZURE_STAGE
  URL = 'azure://ashwinblobst.blob.core.windows.net/retailsales'
  CREDENTIALS = (AZURE_SAS_TOKEN='sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiytfx&se=2025-10-22T18:15:40Z&st=2025-10-22T10:00:40Z&spr=https&sig=JTPA7B2qvLl4Lb%2FRTGY8z18JVA2FdqZL9ireWYnFR1Y%3D')
  FILE_FORMAT = RETAIL_SALES.RETAIL_SALES_SCHEMA.CSV_FILE;

-- List files in the Stage
LIST @RETAIL_SALES.RETAIL_SALES_SCHEMA.AZURE_STAGE;

-- Veryfing Data
SELECT * FROM SALES_DATA;